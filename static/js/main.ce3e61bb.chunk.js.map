{"version":3,"sources":["components/LoadedApp.module.scss","utils/TheMoveDBApi.tsx","utils/toNumber.tsx","components/MovieCard.tsx","components/LoadedApp.tsx","utils/searchMovieList.ts","components/App.tsx","utils/useMovieLists.tsx","reportWebVitals.ts","index.tsx","components/MovieCard.module.scss","components/App.module.scss"],"names":["module","exports","TheMoveDBApi","_key","id","page","params","URLSearchParams","toString","fetch","requestOptions","then","rejectErrors","response","json","a","ok","Error","text","toNumber","value","fallback","undefined","parseInt","_error","method","headers","Headers","Authorization","process","redirect","MovieCard","props","className","styles","data-testid","poster","src","movie","poster_path","alt","info","title","overview","MovieCardSkeleton","cx","skeleton","LoadedApp","useState","searchInput","setSearchInput","searchResults","movieList","needle","lowerCaseNeedle","toLowerCase","filter","replace","includes","searchMovieList","movies","type","SearchInput","placeholder","onChange","event","target","map","LoadedAppSkeleton","error","isError","disabled","message","queryCache","QueryCache","App","basename","exact","from","to","path","render","HomePage","component","FourOhFourPage","movieLists","getList","listId","useParams","useInfiniteQuery","staleTime","cacheTime","Infinity","getFetchMore","lastGroup","total_pages","useEffect","canFetchMore","isFetchingMore","fetchMore","useMovieLists","getMovieList","isLoading","LoadingPage","FiveHundredPage","data","flatMap","results","ControlPanel","toRandomList","Math","max","floor","random","toNextList","toPrevList","Panel","PanelButton","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.ce3e61bb.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"LoadedApp\":\"LoadedApp_LoadedApp__11f6q\",\"error\":\"LoadedApp_error__2vWnV\",\"SearchInput\":\"LoadedApp_SearchInput__1u9iq\"};","import { Key } from 'react';\n\nexport interface Movie {\n  id: Key;\n  poster_path: string;\n  title: string;\n  overview: string;\n}\n\ninterface MovieList {\n  results: Movie[];\n  page: number;\n  total_pages: number;\n}\n\nexport class TheMoveDBApi {\n  static requestOptions: RequestInit = {\n    method: 'GET',\n    headers: new Headers({\n      'Content-Type': 'application/json;charset=utf-8',\n      Authorization: `Bearer ${process.env.REACT_APP_THE_MOVIE_DB_BEARER_TOKEN}`,\n    }),\n    redirect: 'follow',\n  };\n\n  static getList(_key: string, id: Key, page: number = 1): Promise<MovieList> {\n    const params = new URLSearchParams({ page: page.toString() });\n\n    return fetch(\n      `https://api.themoviedb.org/4/list/${id}?${params}`,\n      TheMoveDBApi.requestOptions\n    )\n      .then(rejectErrors)\n      .then((response) => response.json());\n  }\n}\n\nasync function rejectErrors(response: Response) {\n  if (!response.ok) {\n    throw new Error(await response.text());\n  }\n  return response;\n}\n","export function toNumber(value: string | undefined, fallback: number): number {\n  if (value === undefined) {\n    return fallback;\n  }\n  try {\n    return parseInt(value, 10);\n  } catch (_error) {\n    return fallback;\n  }\n}\n","import React from 'react';\nimport { Movie } from '../utils/TheMoveDBApi';\nimport styles from './MovieCard.module.scss';\nimport cx from 'classnames';\n\ninterface MovieCardProps {\n  movie: Movie;\n}\n\nexport function MovieCard(props: MovieCardProps) {\n  return (\n    <article className={styles.MovieCard} data-testid=\"movie-card\">\n      <img\n        className={styles.poster}\n        src={`https://image.tmdb.org/t/p/w500/${props.movie.poster_path}`}\n        alt=\"Poster\"\n      />\n\n      <div className={styles.info}>\n        <h2 className={styles.title}>{props.movie.title}</h2>\n        <p className={styles.overview}>{props.movie.overview}</p>\n      </div>\n    </article>\n  );\n}\n\nexport function MovieCardSkeleton() {\n  return (\n    <article className={cx(styles.MovieCard, styles.skeleton)}>\n      <div className={styles.poster} />\n\n      <div className={styles.info}>\n        <p className={styles.title} />\n        <p className={styles.overview} />\n      </div>\n    </article>\n  );\n}\n","import React, { useState } from 'react';\nimport { searchMovieList } from '../utils/searchMovieList';\nimport { Movie } from '../utils/TheMoveDBApi';\nimport styles from './LoadedApp.module.scss';\nimport { MovieCard, MovieCardSkeleton } from './MovieCard';\nimport cx from 'classnames';\ninterface LoadedAppProps {\n  movies: Movie[];\n}\n\nexport function LoadedApp(props: LoadedAppProps) {\n  const [searchInput, setSearchInput] = useState('');\n\n  const searchResults = searchMovieList(props.movies, searchInput);\n\n  return (\n    <div className={styles.LoadedApp}>\n      <input\n        type=\"search\"\n        className={styles.SearchInput}\n        placeholder=\"Search\"\n        value={searchInput}\n        onChange={(event) => setSearchInput(event.target.value)}\n        data-testid=\"search-movies-input\"\n      />\n\n      {searchResults.map((movie) => (\n        <MovieCard movie={movie} key={movie.id} />\n      ))}\n    </div>\n  );\n}\n\ninterface LoadedAppSkeletonProps {\n  isError?: boolean;\n  message: string;\n}\n\nexport function LoadedAppSkeleton(props: LoadedAppSkeletonProps) {\n  return (\n    <div className={cx(styles.LoadedApp, { [styles.error]: props.isError })}>\n      <input\n        type=\"search\"\n        className={styles.SearchInput}\n        disabled\n        value={props.message}\n      />\n      <MovieCardSkeleton />\n      <MovieCardSkeleton />\n      <MovieCardSkeleton />\n      <MovieCardSkeleton />\n    </div>\n  );\n}\n","export interface SearchableMovie {\n  overview: string;\n}\n\nexport function searchMovieList<T extends SearchableMovie>(\n  movieList: T[],\n  needle: string\n): T[] {\n  const lowerCaseNeedle = needle.toLowerCase();\n  return movieList.filter((movie) =>\n    movie.overview\n      .toLowerCase()\n      .replace(/[^\\w\\d\\s]/gm, '')\n      .includes(lowerCaseNeedle)\n  );\n}\n","import React from 'react';\nimport { QueryCache, ReactQueryCacheProvider } from 'react-query';\nimport { ReactQueryDevtools } from 'react-query-devtools';\nimport {\n  BrowserRouter,\n  Link,\n  Redirect,\n  Route,\n  Switch,\n  useParams,\n} from 'react-router-dom';\nimport { TheMoveDBApi } from '../utils/TheMoveDBApi';\nimport { toNumber } from '../utils/toNumber';\nimport { useMovieLists } from '../utils/useMovieLists';\nimport styles from './App.module.scss';\nimport { LoadedApp, LoadedAppSkeleton } from './LoadedApp';\n\ninterface AppProps {\n  getMovieList?: typeof TheMoveDBApi.getList;\n}\n\nconst queryCache = new QueryCache();\n\nexport function App(props: AppProps) {\n  return (\n    <ReactQueryCacheProvider queryCache={queryCache}>\n      <BrowserRouter basename={process.env.PUBLIC_URL}>\n        <Switch>\n          <Redirect exact from=\"/\" to=\"/1\" />\n          <Route path=\"/:listId(\\d+)\" render={() => <HomePage {...props} />} />\n          <Route component={FourOhFourPage} />\n        </Switch>\n      </BrowserRouter>\n      <ReactQueryDevtools />\n    </ReactQueryCacheProvider>\n  );\n}\n\nfunction HomePage(props: AppProps) {\n  const getList = props.getMovieList ?? TheMoveDBApi.getList;\n  const movieLists = useMovieLists(getList);\n\n  if (movieLists.isLoading) {\n    return <LoadingPage />;\n  }\n\n  if (movieLists.isError) {\n    return <FiveHundredPage />;\n  }\n\n  const movies = movieLists.data!.flatMap((movieList) => movieList.results);\n  return (\n    <div className={styles.App}>\n      <LoadedApp movies={movies} />\n      <ControlPanel />\n    </div>\n  );\n}\n\nfunction LoadingPage() {\n  return (\n    <div className={styles.App}>\n      <LoadedAppSkeleton message=\"\" />\n      <ControlPanel />\n    </div>\n  );\n}\nfunction FiveHundredPage() {\n  return (\n    <div className={styles.App}>\n      <LoadedAppSkeleton isError message=\"Something went wrong\" />\n      <ControlPanel />\n    </div>\n  );\n}\nfunction FourOhFourPage() {\n  return (\n    <div className={styles.App}>\n      <LoadedAppSkeleton isError message=\"Page Not Found\" />\n      <ControlPanel />\n    </div>\n  );\n}\n\nfunction ControlPanel() {\n  const params = useParams<{ listId?: string }>();\n  const listId = toNumber(params.listId, 1);\n\n  const toRandomList = `/${Math.max(1, Math.floor(Math.random() * 10000))}`;\n  const toNextList = `/${listId + 1}`;\n  const toPrevList = `/${Math.max(1, listId - 1)}`;\n\n  return (\n    <div className={styles.Panel}>\n      <Link to={toNextList} className={styles.PanelButton}>\n        +\n      </Link>\n      <Link to={toRandomList} className={styles.PanelButton}>\n        ?\n      </Link>\n      <Link to={toPrevList} className={styles.PanelButton}>\n        -\n      </Link>\n    </div>\n  );\n}\n","import { useEffect } from 'react';\nimport { useInfiniteQuery } from 'react-query';\nimport { useParams } from 'react-router-dom';\nimport { TheMoveDBApi } from './TheMoveDBApi';\nimport { toNumber } from './toNumber';\n\nexport function useMovieLists(getList: typeof TheMoveDBApi.getList) {\n  const params = useParams<{ listId?: string }>();\n  const listId = toNumber(params.listId, 1);\n\n  const movieLists = useInfiniteQuery(['movieList', listId], getList, {\n    staleTime: 60 * 5 * 1000,\n    cacheTime: Infinity,\n    getFetchMore: (lastGroup) => {\n      if (lastGroup.page >= lastGroup.total_pages) {\n        return;\n      }\n\n      return lastGroup.page + 1;\n    },\n  });\n\n  // iterate through pages\n  useEffect(() => {\n    if (movieLists.canFetchMore && !movieLists.isFetchingMore) {\n      movieLists.fetchMore();\n    }\n  }, [movieLists]);\n\n  return movieLists;\n}\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);  \n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n}\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport { App } from './components/App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"MovieCard\":\"MovieCard_MovieCard__1QTdo\",\"skeleton\":\"MovieCard_skeleton__17K88\",\"poster\":\"MovieCard_poster__Q1BYT\",\"title\":\"MovieCard_title__pu03D\",\"overview\":\"MovieCard_overview__aVaLJ\",\"info\":\"MovieCard_info__b2BHy\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"App\":\"App_App__rq8wc\",\"Panel\":\"App_Panel__1fvm-\",\"PanelButton\":\"App_PanelButton__3ZevQ\"};"],"sourceRoot":""}